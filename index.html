<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ابن عثيمين | ذكاء اصطناعي</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --bg-dark: #0f172a; --card-dark: #1e293b; --gold-primary: #d4af37; --text-gray: #94a3b8; }
        body { background: radial-gradient(circle at top, #1e293b 0%, #0f172a 100%); color: white; font-family: 'Segoe UI', sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        .header { display: flex; align-items: center; justify-content: flex-end; width: 100%; max-width: 400px; margin-top: 40px; gap: 15px; }
        .header-text { text-align: right; }
        .header-text h2 { margin: 0; font-size: 1.25rem; }
        .profile-img { width: 75px; height: 75px; border-radius: 50%; border: 2px solid var(--gold-primary); background-image: url('https://upload.wikimedia.org/wikipedia/ar/c/c2/Muhammad_bin_Salih_al-Uthaymeen.jpg'); background-size: cover; background-position: center; }
        .ayah { color: var(--gold-primary); font-weight: bold; margin: 60px 0; text-align: center; font-size: 1.15rem; }
        .search-wrapper { width: 100%; max-width: 400px; display: flex; align-items: center; background-color: rgba(30, 41, 59, 0.6); border: 1px solid #334155; border-radius: 14px; padding: 6px; margin-bottom: 30px; }
        .send-btn { background-color: #334155; color: white; border: none; border-radius: 10px; width: 48px; height: 48px; cursor: pointer; display: flex; align-items: center; justify-content: center; }
        input { flex: 1; background: transparent; border: none; padding: 12px 15px; color: white; text-align: right; font-size: 16px; outline: none; }
        #response-area { width: 100%; max-width: 400px; background: rgba(30, 41, 59, 0.8); border-radius: 15px; padding: 20px; margin-bottom: 40px; display: none; border-right: 4px solid var(--gold-primary); line-height: 1.8; text-align: justify; white-space: pre-line; }
        .loading { color: var(--gold-primary); font-style: italic; font-size: 14px; margin-bottom: 20px; display: none; }
        .info-section { width: 100%; max-width: 400px; text-align: right; margin-bottom: 50px; }
        .donation-card { background-color: rgba(30, 41, 59, 0.4); width: 100%; max-width: 400px; padding: 25px; border-radius: 24px; border: 1px solid #334155; text-align: center; box-sizing: border-box; }
        .pay-button { background-color: #ffc439; color: #003087; display: block; padding: 15px; border-radius: 12px; font-weight: bold; text-decoration: none; border: none; width: 100%; font-size: 1.1rem; margin-bottom: 20px; cursor: pointer; }
        .footer { margin-top: 60px; padding-bottom: 30px; color: #475569; font-size: 0.8rem; text-align: center; }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-text">
            <h2>محمد بن صالح بن عثيمين</h2>
            <p style="color:var(--text-gray); font-size:0.85rem;">محرك بحث فقهي ذكي</p>
        </div>
        <div class="profile-img"></div>
    </div>
    <div class="ayah">"فَاسْأَلُوا أَهْلَ الذِّكْرِ إِن كُنتُمْ لَا تَعْلَمُونَ"</div>
    <div class="search-wrapper">
        <button class="send-btn" onclick="askSheikh()">
            <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
        </button>
        <input type="text" id="user-input" placeholder="اكتب سؤالك الشرعي هنا..." onkeypress="if(event.key==='Enter') askSheikh()">
    </div>
    <div id="loading-msg" class="loading">جاري استحضار فتوى الشيخ...</div>
    <div id="response-area"></div>
    <div class="info-section">
        <div style="font-weight:bold; margin-bottom:15px;">عن المفتي الرقمي ⓘ</div>
        <div style="color:var(--text-gray); font-size:0.95rem; line-height:1.7;">منصة وقفية تهدف لإحياء تراث الشيخ ابن عثيمين رحمه اللّٰه باستخدام الذكاء الاصطناعي.</div>
    </div>
    <div class="donation-card">
        <button class="pay-button" onclick="tg.openLink('https://www.paypal.com/paypalme/AbedAlfattahJafer')">Pay with PayPal</button>
    </div>
    <div class="footer">تطوير وإشراف: عبدالفتاح الشوابكة (@abdkb96)</div>
    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();
        async function askSheikh() {
            const input = document.getElementById('user-input');
            const responseArea = document.getElementById('response-area');
            const loading = document.getElementById('loading-msg');
            if (!input.value.trim()) return;
            loading.style.display = 'block';
            responseArea.style.display = 'none';
            try {
                const response = await fetch("https://uthaymeen-ai.jok720er.workers.dev/", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({ question: input.value })
                });
                const data = await response.json();
                loading.style.display = 'none';
                responseArea.style.display = 'block';
                responseArea.innerHTML = `<b>إجابة الشيخ:</b><br>${data.answer}`;
            } catch (e) {
                loading.innerText = "حدث خطأ في الاتصال، حاول ثانية.";
            }
        }
    </script>
</body>
</html>
